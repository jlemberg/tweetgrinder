var tweetgrinder=function(){function a(){var a,c,d,e,f=(new Date).getTime();for(r.html(""),b("Executing "+m+" plugins\n"),a=0,c=l.length;c>a;a++)l[a].useGraph&&(s.css({display:"block"}),s.prev().css({display:"block"}),l[a].graphContext.canvas.width=l[a].graphContext.canvas.width,$(l[a].graphContext.canvas.parentNode).children().not("canvas").remove()),l[a].before(j),l[a].global(p,j);for(a=1,c=p.length;c>a;a++)for(d=0,e=l.length;e>d;d++)l[d].during(p[a],j);for(a=0,c=l.length;c>a;a++)b("Plugin "+l[a].name+":"),l[a].after(j),b("");var g=(new Date).getTime(),h=g-f;b("Total plugin execution time: "+h+"ms")}function b(a,b){b||(a+="<br />"),r.append(a)}function c(a){l.push(a)}function d(){b("Loading plugins");for(var a=0;m>a;a++){b('Loading plugin "'+k[a]+'" ('+(a+1)+"/"+m+")");var c=document.createElement("script");c.type="text/javascript",c.src="src/plugins/"+k[a]+".js",c.onload=e;var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(c,d)}}function e(){o=++n==m,o&&(b("All plugins loaded"),f())}function f(){for(var a=$("#config_anchor"),c=$("#output_anchor"),d=0,e=l.length;e>d;d++){if(b('Initializing plugin "'+l[d].name+'"... ',!0),l[d].config){var f=$('<div class="config_element"></div>');t.css({display:"block"}),t.prev().css({display:"block"});for(var g in l[d].config){var h=l[d].config[g],i=$('<input type="'+h.type+'" value="'+h.value+'" id="plugin_'+d+"_config_"+g+'"/>');i.bind("change",function(a,b){return function(){a.config[b].value=this.value}}(l[d],g));var j=$('<label for="'+i.attr("id")+'">'+h.label+"</label>"),k=$("<span>"+l[d].name+"</span>");f.append(k).append("<br />").append(i).append(j).append("<br />")}f.insertBefore(a)}if(l[d].useGraph){f=$('<div class="output_element"></div>');var m=$('<canvas width="500" height="500"></canvas>');f.append(m),f.insertBefore(c);var n=m[0].getContext("2d");l[d].graphContext=n}b("done")}}function g(b){if(b.stopPropagation(),b.preventDefault(),originalEvent=b.originalEvent,!(originalEvent.dataTransfer.files.length>1)&&o){q.unbind("drop",g),q.unbind("dragover",h);var c=originalEvent.dataTransfer.files[0],d=new FileReader;d.onload=function(b){p=$.csv.toArrays(b.target.result);for(var c=0,d=p[0].length;d>c;c++)j[p[0][c]]=c;q.html("Now click here to start GRINDING"),q.bind("click",a)},d.readAsText(c)}}function h(a){a.stopPropagation(),a.preventDefault(),a.originalEvent.dataTransfer.dropEffect="copy"}function i(){q=$("#drop"),r=$("#output"),s=$("#graph_output"),t=$("#config_area"),d(),q.bind("drop",g),q.bind("dragover",h)}var j={},k=["linecount","wordcount","tweetsource","swears","hashtagusage","linktypes","tweettimes"],l=[],m=k.length,n=0,o=!1,p=null,q=$("#drop"),r=$("#output"),s=$("#graph_output"),t=$("#config_area"),u={hookPlugin:c,init:i,log:b,pluginPrototype:{name:"",before:function(){},global:function(){},during:function(){},after:function(){},useGraph:!1,graphContext:null,config:null}};return u}();$(document).ready(function(){tweetgrinder.init()});